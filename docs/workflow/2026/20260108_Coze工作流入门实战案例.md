# Coze入门实战案例

> [教程地址](https://www.bilibili.com/video/BV117RAY8EYM/?spm_id_from=333.337.search-card.all.click&vd_source=f87f39b1af12eeb6301c7d9944f97ec9)

## 快速开始

### 创建智能体

​	　首先，访问[扣子编程](https://code.coze.cn/home)，然后点击【智能体开发】进入智能体创建页面，在弹出的页面上，输入**智能体名称**和设置完**图标**。

<Img src  = 'https://github.com/sh086/picx-images-hosting/raw/master/20260108/image-20260106205200425.4n875vycds.webp' />

​	　点击确认，即可创建成功。然后在智能体配置页面的左侧输入【人设与回复逻辑】，**建议使用AI优化一下提示词**，完成后就可进行预览与调试了。

<Img src  = 'https://github.com/sh086/picx-images-hosting/raw/master/20260108/image-20260106211523024.6bhk32w0vg.webp' />



### 发布到商店

​	　点击**右上角**的**发布**按钮，即可进入发布页，选择发布渠道后，点击发布按钮，即可提起发布申请。

<Img src  = 'https://github.com/sh086/picx-images-hosting/raw/master/20260108/image-20260106133101198.8z70dfqywe.webp' />

​	　目前发布是需要审核的，等审核通过后，可通过下图所示，快速找到该智能体，并分享到社交平台上，用户需注册Coze平台后方可使用。

<Img src  = 'https://github.com/sh086/picx-images-hosting/raw/master/20260108/image-20260106214737199.1lcb4p0sgt.webp' />

> PS：或者在商店搜索【**深夜情感客服@用户名**】也可搜到该智能体



## 编排参数优化

### 模型设置

1、生成随机性（temperature）

（1）配置说明

​	　调高温度增加模型的输出更多样性和创新性，反之会使输出内容更加遵循指令要求但减少多样性。建议不要与 “Top p” 同时调整。

```
0.1 ~ 0.3 用于知识问答、技术文档生成、法律文书撰写
0.4 ~ 0.7 用于故事续写、文章摘要生成、对话系统
0.8 ~ 1.0 用于诗歌、科幻小说、创意写作、搞笑内容、文案广告创作等
```



（2）原理

​	　模型预测的每个词都有一个概率，这些概率组成了一个概率分布，temperature可以对这个概率分布进行调整。

​	　当temperature**值小**的时候，概率分布会变得更**陡峭**，也就是高概率的词会变得更高概率，低概率的词会变得更低概率，模型就更倾向于选择高概率的词，生成的文本就比较确定；

​	　当temperature**值大**的时候，概率分布会变得更**平缓**，高概率和低概率的差距变小，低概率的词也有更大的机会被选中，生成的文本就更具多样性。

```
若模型预测下一个词:
   “餐厅”概率0.3、“超市”概率0.25、书店”概率0.2

场景一：配置低temperature（如0.2），经过低temperature调整后：
   “餐厅”概率0.8、“超市”概率0.05、书店”概率0.01
此时，超市”和“书店”等概率变得很低，模型几乎肯定会选“餐厅”作为下一个词
生成的文本就比较常规、确定

场景二：配置高temperature（如0.8），经过低temperature调整后：
   “餐厅”概率0.35、“超市”概率0.3、书店”概率0.25
此时，这样超市、书店原本概率不是最高的词也有较大机会被选中
生成的文本就更有创意和多样性，但可能也会出现一些不太符合常理的情况
```



2、Top p（累计概率）

（1）配置说明

​	　值越低低概率的词出现的越少（越严谨合理），值越高低概率的词出现的越多（越天马行空），建议不要与 “生成随机性” 同时调整。

```
0.6 ~ 0.8 技术学术文档或法律条文，需要高度的准确性和专业性
0.8 ~ 0.95 新闻写作或日常对话，兼顾准确性和多样性
0.95 ~ 0.99 创意写作或广告营销文案
```



（2）原理

​	　模型在生成输出时会从概率最高的词汇开始选择，直到这些词汇的总概率累积达到 Top p 值。这样可以限制模型只选择这些高概率的词汇，从而控制输出内容的多样性。

```
假如p=0.8，模型预测的下一个词可能有：
   “餐厅”（概率0.3）、“超市”（概率0.25）、“书店”（概率0.2）
   “公园”（概率0.1）、“银行”（概率0.05）
从概率最高的“餐厅”开始累加：
   “餐厅”（0.3）+“超市”（0.25）+“书店”（0.2）=0.75，还没达到0.8
再加上“公园”（0.1），累加和变为0.85，超过了0.8。
那么餐厅、超市、书店、公园就构成了一个小范围，
模型只会从这几个词里随机选一个作为下一个词，像“银行”这种概率较低的词就被排除在外了
这样做能保证生成的文本比较合理，不会出现一些很奇怪的词。
```



3、携带上下文轮数

​	　设置带入模型上下文的对话历史轮数。轮数越多，多轮对话的相关性越高，回复的也越精准，但消耗的 Token 也越多。



### 插件

​	　我们还可以在调用插件来增强Agent的能力，在`技能`点击`加号`即可弹出如下页面添加插件，以知乎热榜为例。

<Img src  = 'https://github.com/sh086/picx-images-hosting/raw/master/20260108/image-20260106230445406.3d59zlkyeg.webp' />

​	　添加完成后，还需先在左侧的提示词中去掉`对话内容必须围绕提供正向情感呵护展开`的限制，并且建议使用通用型模型，如`豆包-15.5-pro-角色扮演`这种指向性强的模型不要使用。

​	　然后，在对话框中输入`今天知乎热榜有什么`，Agent可以根据对话内容调用对应的插件。

PS：这里插件存在问题，未能实现

拓展：也可在提示词中指定应该调用哪个插件，如：

```
###技能4:特殊内容处理
1.如果用户输入郭德纲，就帮我根据郭德纲去必应搜索3张图片
2.将搜索到的图片用表格的形式展示出来
```



### 知识

​	　可以在Agent里面加入知识库。目前支持上传文本、表格和图片三种类型的资料，上传后系统会自动进行处理，也可进行手动标注。

<Img src  = 'https://github.com/sh086/picx-images-hosting/raw/master/20260108/image-20260107001049927.9ddg4bvcsn.webp' />



### 记忆

1、使用**变量**记录简单的数据

​	　在清空对话窗口或者超过上下文最大文本时，Agent就会忘记谈话内容，对于一些重要的信息，可以存储到用户变量中进行持久化记忆。

<Img src  = 'https://github.com/sh086/picx-images-hosting/raw/master/20260108/image-20260107120124174.2rvmdas61g.webp' />

​	　按照上述新增`姓名`和`年龄`两个用户变量后，输入`我是张三`，智能体即可识别并记录你的名字到用户变量中。然后，清空聊天记录，再次询问`我是谁`，虽然这次没告诉智能体你是谁，但智能体仍可以回答`您的名字是张三`。



2、使用`数据库`记录复杂结构

​	　但是对于复杂点的逻辑，使用变量的方式是不行的。以记账为例，我们新增一个用于记账的数据库，包含`name-姓名`、`money消费金额`、`memo消费明细`三个字段。

<Img src  = 'https://github.com/sh086/picx-images-hosting/raw/master/20260108/image-20260107132228612.icltt8s8r.webp' />

​	　然后我们对新增的记账数据库进行测试，测试效果如下：

<Img src  = 'https://github.com/sh086/picx-images-hosting/raw/master/20260108/image-20260107132533216.8s3si143on.webp' />



### 对话体验

1、开场白

​	　用于设置**开场白文案**和**开场白预置问题**。

<Img src = 'https://github.com/sh086/picx-images-hosting/raw/master/20260108/image-20260107174954858.54y8uibd7j.webp' />



2、用户问题建议

​	　开启`用户问题建议`后，每当智能体回答完用户的问题，智能体都会自动根据**对话内容**提供3条用户提问建议。

<Img src = 'https://github.com/sh086/picx-images-hosting/raw/master/20260108/image-20260107174859051.1sfj04t76t.webp' />



3、快捷指令

​	　用户可以通过快捷指令快速发起预设对话。

<Img src = 'https://github.com/sh086/picx-images-hosting/raw/master/20260108/image-20260107212601390.9ddg4c27xw.webp' />



4、语音

<Img src = 'https://github.com/sh086/picx-images-hosting/raw/master/20260108/image-20260107213338909.73ufkui8zd.webp' />



## 工作流

​	　如果智能体的逻辑比较简单，就可以在提示词中用自然语言告诉大语言模型，但如果是复杂的业务，用自然语言的方式就没那么明确和便捷。此时，可以使用工作流来实现明确执行的流程。

### 从添加插件开始

1、新增最简单的工作流

​	　按下图所示，创建一个初始工作流，只包含开始和结束。

<Img src = 'https://github.com/sh086/picx-images-hosting/raw/master/20260108/image-20260107230207587.6bhk342pmj.webp' />



2、添加插件

​	　然后，我们添加一个获取抖音视频文案的插件，并进行测试。

<Img src = 'https://github.com/sh086/picx-images-hosting/raw/master/20260108/image-20260107231147552.2rvmdb0rie.webp' />



> PS：测试使用的抖音地址 -> https://www.douyin.com/video/7588132848016608563



### 搭建工作流

1、将开始与插件链接起来

<Img src = 'https://github.com/sh086/picx-images-hosting/raw/master/20260108/image-20260107231859418.2vf8b0uabt.webp' />



2、新增大模型进行文案改写

​	　获取抖音文案后，在交予大模型进行文案改写，并以JSON格式输出。

<Img src = 'https://github.com/sh086/picx-images-hosting/raw/master/20260108/image-20260108110743580.77e1ike5ps.webp' />



3、新增大模型进行格式变更

​	　让大模型将改写的文案格式调整为MarkDown，并给出拍摄建议。

<Img src = 'https://github.com/sh086/picx-images-hosting/raw/master/20260108/image-20260108141841671.6t7lrp6nem.webp' />



::: details 图片中的系统提示词

```
#角色
你是一位专业的Markdown格式编写专家，也是短视频创作助手。能够精准地将给定文案转化为符合Markdown格式的内容，同时为每段视频内容规划出推荐拍摄时间，为短视频创作者提供具有参考价值的拍摄建议。

##技能
###技能1:转换Markdown格式
1.接收用户输入的文案内容
2.将文案转化为标准的Markdown格式
###技能2：拍摄时长规划和建议
1.对文案的每一句提供提供拍摄时间规划和建议
2.输出格式：每一句话【拍摄时长】【拍摄建议）

##限制：
只国绕文案转化为Markdown格式以及生成推荐拍摄时
问进行回复，拒绝回答与该任务无关的话题。
所输出的内容必须按照给定的格式进行组织，不能偏离
框架要求。
```

::: 



4、设置结束节点

<Img src = 'https://github.com/sh086/picx-images-hosting/raw/master/20260108/image-20260108154830175.3govxbqpls.webp' />



### 测试与发布

​	　工作流搭建完成后，再试运行一下，若没有错误，即可点击右上角的发布。

<Img src = 'https://github.com/sh086/picx-images-hosting/raw/master/20260108/image-20260108155649263.7i0vbpvg8w.webp' />

​	　工作流发布后，智能体才可使用，我们在对话框输入一个抖音视频地址，智能体就可以返回我们预设的工作流执行结果啦。

<Img src = 'https://github.com/sh086/picx-images-hosting/raw/master/20260108/image-20260108161002145.3d59zlz38v.webp' />



## 附录：提示词

::: details 深夜情感客服

```
#角色
你是一个情感呵护机器人，专为内心脆弱的单身男女提供情感陪护，只传递正向的情绪价值，绝不涉及任何负面内容，避免给对方带来负面情绪影响

##技能
###技能1：倾听与回应
1.认真倾听聊天对象分享的各种事情。
2.基于对方的话语，给出积极、鼓励、安慰且充满正能量的回应。

###技能2：主动引导积极话题
1.在对话中适时主动开启积极向上的话题，如美好的回忆、有趣的爱好等。
2.引导聊天对象关注生活中的美好和积极面。

##限制：
-对话内容必须围绕提供正向情感呵护展开，杜绝任何负面信息。
-回应需简洁明了，符合积极正能量的风格。
```

:::

::: details 留学知识库

```
#角色
你是留学知识库的智能助手，能够以清晰易懂的方式，向新员工讲解留学业务相关知识，帮助他们快速熟悉业务并为客户提供优质服务

##技能
###技能1：解答留学业务基础问题
1.当新员工提出关于留学业务的基础问题，如留学流程、申请材料等，使用知识库中的知识进行解答
2.如果知识库中没有相关内容，使用合适的工具搜索相关信息
3.以简洁明了的语言向新员工闸述答案。
==回复示例===
**问题*：<新员工提出的问题
**答案**：<详细的解答内容>
==示例结束===

###技能2：提供特定留学场景案例分析
1.当新员工需要了解特定留学场景下的应对方法，如处理客户紧急情况、应对复杂申请等，从知识库中检索相关案例
2.若知识库中案例不足，通过工具搜索补充案例信息
3.分析案例并向新员工说明处理思路和要点
==回复示例===
**场景描述**：<具体留学场景
**案例**：<详细案例内容>
**分析与要点**：<针对案例的分析及处理要点>资料vapython2666
===示例结束===

###技能3：介绍留学相关政策和超势
1.新员工询间留学相关政策变化或趋势时，先从知识库获取信息
2.利用工具搜索最新的政策和趋势动态。
3.向新员工清晰介绍相关政策和趋势内容
===回复示例===
**政策/趋势主题**：<具体主题>
**详细信息**：<相关政策或趋势的具体内容>
=示例结束==

##限制：
只讨论与留学业务相关的内容，拒绝回答与留学业务无关的话题
所输出的内容必须逻辑清晰，便于新员工理解
回答应简洁明了，重点突出。
优先输出知识库中已有内容，知识库中没有的信息，通过工具去获取。
请使用Markdown的形式说明引用来源
```

:::

::: details 抖音爆款文案

```
##角色
你是一位抖音爆款文案创作大师，擅长将现有的文案进行巧妙改写，同时能够凭借丰富的创意生成全新的抖音爆款文案

##技能
###技能1：改写爆款文案
1.当用户提供一条抖音文案让你改写时，仔细分析文案的主题、风格、受众群体等关键要素
2.从语言表达、叙事结构、创意亮点等方面入手，对原始文案进行全方位优化，确保改写后的文案既保留原意，又更具吸引力和传播力

###技能2：生成新的爆款文案
1.根据用户提供的主题，结台当下抖音热门趋势和受众喜好，创作出具有独特创意、语言生动且能吸引大量关注的爆款文案

##限制：
只围绕抖音爆款文案的改写和创作展开，拒绝回答与该主题无关的话题
所输出的文案内容需简洁明了、富有创意，符合抖音平台的风格特点
生成或改写的文案需符合用户提出的主题和基本要求
```

:::